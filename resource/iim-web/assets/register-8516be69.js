import{b as S,a2 as C,r as h,d as I,bD as K,e as $,f as D,h as E,w as t,j as o,i as r,c as s,aX as p,aD as g,H as w,C as i,q as N,v as R,t as q,a$ as T,cc as U,x as V,y as B}from"./index-7540fc5d.js";import{a as z}from"./auth-7e0a8ef8.js";import{S as A,c as b,b as F}from"./common-3b825c45.js";const M=u=>(V("data-v-6d3d72e7"),u=u(),B(),u),j={class:"el-container is-vertical login-box reister"},G=M(()=>r("header",{class:"el-header box-header"},[r("i",{class:"login-box-logo"}),i(" 欢迎注册 IIM ")],-1)),H={class:"el-main",style:{padding:"3px"}},L={class:"helper"},P={__name:"register",setup(u){const f=C(),_=h(),y={nickname:{required:!0,trigger:["blur","input"],message:"昵称不能为空"},username:{required:!0,validator(n,e){if(e){if(!b(e))return new Error("请正确填写邮箱")}else return new Error("邮箱不能为空");return!0},trigger:["blur","input"]},password:{required:!0,trigger:["blur","input"],message:"密码不能为空"},code:{required:!0,trigger:["blur","input"],message:"验证码不能为空"}},c=h(0),v=new A("REGISTER_SMS",60,n=>{c.value=n}),a=I({nickname:"",username:"",password:"",code:"",loading:!1}),k=()=>{a.loading=!0;const n=z({nickname:a.nickname,account:a.username,password:a.password,code:a.code,platform:"web"});n.then(e=>{e.code==200?(window.$message.success("注册成功"),setTimeout(()=>{f.push("/auth/login")},500)):window.$message.warning(e.message)}),n.finally(()=>{a.loading=!1})},d=n=>{n.preventDefault(),_.value.validate(e=>{!e&&k()})},x=()=>{if(!b(a.username)){window.$message.warning("请正确填写邮箱");return}const n=F({email:a.username,channel:"register"});v.start(),n.then(e=>{e.code==200?(window.$message.success("验证码发送成功"),e.data.is_debug&&(a.code=e.data.code,setTimeout(()=>{window.$message.success("已开启验证码自动填充")},1e3))):(window.$message.warning(e.message),v.end())}),n.finally(()=>{a.loading=!1})};return K(()=>{v.clear()}),(n,e)=>{const m=$("n-button");return D(),E(o(U),{theme:null},{default:t(()=>[r("section",j,[G,r("main",H,[s(o(T),{ref_key:"formRef",ref:_,size:"large",model:a,rules:y},{default:t(()=>[s(o(p),{path:"username","show-label":!1},{default:t(()=>[s(o(g),{placeholder:"请输入邮箱",value:a.username,"onUpdate:value":e[0]||(e[0]=l=>a.username=l),onKeydown:w(d,["enter","native"])},null,8,["value","onKeydown"])]),_:1}),s(o(p),{path:"code","show-label":!1},{default:t(()=>[s(o(g),{placeholder:"验证码",value:a.code,"onUpdate:value":e[1]||(e[1]=l=>a.code=l),maxlength:6,onKeydown:w(d,["enter","native"])},null,8,["value","onKeydown"]),s(m,{tertiary:"",class:"mt-l5",onClick:x,disabled:c.value>0},{default:t(()=>[i(" 获取验证码 "),N(r("span",null,"("+q(c.value)+"s)",513),[[R,c.value>0]])]),_:1},8,["disabled"])]),_:1}),s(o(p),{path:"nickname","show-label":!1},{default:t(()=>[s(o(g),{placeholder:"设置昵称",value:a.nickname,"onUpdate:value":e[2]||(e[2]=l=>a.nickname=l),maxlength:20,onKeydown:w(d,["enter","native"])},null,8,["value","onKeydown"])]),_:1}),s(o(p),{path:"password","show-label":!1},{default:t(()=>[s(o(g),{placeholder:"设置密码",type:"password","show-password-on":"click",value:a.password,"onUpdate:value":e[3]||(e[3]=l=>a.password=l),onKeydown:w(d,["enter","native"])},null,8,["value","onKeydown"])]),_:1}),s(m,{type:"primary",size:"large",block:"",class:"mt-t20",onClick:d,loading:a.loading},{default:t(()=>[i(" 立即注册 ")]),_:1},8,["loading"])]),_:1},8,["model"]),r("div",L,[s(m,{text:"",color:"#D4A978",onClick:e[4]||(e[4]=l=>o(f).push("/auth/forget"))},{default:t(()=>[i(" 找回密码 ")]),_:1}),s(m,{text:"",color:"#D4A978",onClick:e[5]||(e[5]=l=>o(f).push("/auth/login"))},{default:t(()=>[i(" 已有账号，立即登录? ")]),_:1})])])])]),_:1})}}},Q=S(P,[["__scopeId","data-v-6d3d72e7"]]);export{Q as default};
